<semantic-form
  new-subject-template='https://archipelago.itatti.harvard.edu/resource/source/{{{{raw}}}}{{UUID}}{{{{/raw}}}}'
  fields='[[ fieldDefinitions
    type="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
    label="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/archipelago_label"

    source_identifier="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/archipelago_label_single"
    source_original_title="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_original_title"
    source_attributed_title="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_attributed_title"

    source_author="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/builtwork_construction_actor-role_actor"
    entity_production_date="http://localhost:10214/container/fieldDefinitionContainer/entity_production_date"

    has_type="http://localhost:10214/container/fieldDefinitionContainer/source_typology"
    is_subject_of="http://www.cidoc-crm.org/cidoc-crm/P129i_is_subject_of"
    source_production="http://localhost:10214/container/fieldDefinitionContainer/source_production"

    source_location="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_location"
    source_location_medium="http://localhost:10214/container/fieldDefinitionContainer/source_location_medium"
    source_location_final="http://localhost:10214/container/fieldDefinitionContainer/source_location_final"
    source_technique="http://localhost:10214/container/fieldDefinitionContainer/source_technique_medium"

    source_dimension="http://localhost:10214/container/fieldDefinitionContainer/source_dimension"
    source_dimension_unit="http://localhost:10214/container/fieldDefinitionContainer/source_dimension_unit"

    P138i_has_representation="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/veniss_source_representation"
    source_was_measured_by="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_was_measured_by"
    
    related_actors="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_related_actor"
    related_events="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_related_events"
    related_builtworks="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_related_builtworks"

    source_synopsis="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_synopsis"
    source_transcription="https://archipelago.itatti.harvard.edu/container/fieldDefinitionContainer/source_transcription"
  ]]'
  [[>rsp:FormDefaults]]
>
<div class="form-scroll-area">

  <semantic-form-hidden-input for="type" default-values='["http://www.cidoc-crm.org/cidoc-crm/E22_Man-Made_Object","https://archipelago.itatti.harvard.edu/arconto#Source"]'></semantic-form-hidden-input>

  <div class="container-fluid">
    <div data-flex-layout="row stretch-stretch">

      <!-- Left -->
      <div data-flex-self="size-x2">

        <div data-flex-layout="column stretch-stretch">

          <!-- Representation and titles -->
          <div data-flex-layout="row top-stretch">

            <div id="source_visual_representation" class="padding-5">

              <semantic-form-file-input 
                label="Visual representation"
                for="P138i_has_representation"
                storage='images'
                temp-storage='tmp'
                placeholder='Add file here'
                name-predicate-iri='http://www.researchspace.org/ontology/PX_has_file_name'
                media-type-predicate-iri='http://www.researchspace.org/ontology/PX_has_media_type'
                resource-query='
                  PREFIX rso: <http://www.researchspace.org/ontology/>
                  CONSTRUCT {
                    ?__resourceIri__ a rso:EX_File.
                    ?__resourceIri__ rso:PX_has_file_name ?__fileName__.
                    ?__resourceIri__ rso:PX_has_media_type ?__mediaType__.
                    ?__resourceIri__ rdfs:label ?__filename__.
                  } WHERE {}
                '
                generate-iri-query='
                  SELECT ?resourceIri {
                    BIND(IRI(CONCAT(STR(Default:), "EX_File/", ?__fileName__)) AS ?resourceIri) .
                  }
                '
              ></semantic-form-file-input>
            
            </div>

            <div data-flex-layout="column top-stretch" data-flex-self="size-x3">

              <div id="source_attributed_title" class="padding-5">
                <semantic-form-text-input languages='["en", "it"]' label="Attributed title" for="source_attributed_title"></semantic-form-text-input>
              </div>

              <div id="source_original_title" class="padding-5">
                <semantic-form-text-input languages='["en", "it"]' label="Original title" for="source_original_title"></semantic-form-text-input>
              </div>

              <div id="source_typology" class="padding-5">
                <semantic-form-tree-picker-input 
                  for='has_type'
                  label="Typology"
                  placeholder="Click and start type"
                  tree-patterns='{
                    "relationPattern": "?item skos:broader ?parent", 
                    "schemePattern": "?item crm:P71i_is_listed_in <http://www.researchspace.org/resource/vocab/source_types>"
                  }'>
                </semantic-form-tree-picker-input>
              </div>

            </div>

          </div>

          <hr>

          <!-- Author and Date -->
          <div data-flex-layout="row top-stretch">

            <div id="source_author" class="padding-5">
              <semantic-form-select-input label="Author" for='source_author' placeholder="Start type to filter the authors"></semantic-form-select-input>
            </div>
            
            <div id="source_production_date" class="padding-5">
              <semantic-form-datetime-input label="Creation date" for='entity_production_date' placeholder="YYYY-MM-DD"></semantic-form-datetime-input>
            </div>

          </div>

          <hr>

          <!-- Archival location  -->
          <div data-flex-layout="row top-stretch">

            <div id="source_location" class="padding-5" data-flex-layout="row top-stretch">
              <div data-flex-self="size-x3">
                <semantic-form-tree-picker-input 
                  open-dropdown-on-focus="false"
                  label="Archival Location" 
                  for='source_location'
                  placeholder="Search for things"
                  custom-button='{
                    "iri": "http://www.researchspace.org/resource/ThinkingFrames",
                    "view": "authority-content",
                    "resource": "http://www.researchspace.org/resource/vocab/archives"
                  }'
                  query-item-label="arconto:has_full_path"
                  tree-patterns='{
                    "relationPattern": "?item crm:P46i_forms_part_of ?parent", 
                    "schemePattern": "?item crm:P71i_is_listed_in <http://www.researchspace.org/resource/vocab/archives>"
                  }'>
                </semantic-form-tree-picker-input>
              </div>
              
            </div>

          </div>

          <div data-flex-layout="row top-stretch">

            <div id="source_final_medium" class="padding-5">
              <semantic-form-select-input label="Source medium" placeholder="Choose the source medium" for='source_location_medium'>
              </semantic-form-select-input>
            </div>

            <div id="source_final_title" class="padding-5">
              <semantic-form-text-input label="Medium title" placeholder="Write the medium title" for='source_location_final'>
              </semantic-form-text-input> 
            </div>

          </div>

          <!-- Medium and Dimension -->
          <div data-flex-layout="row top-stretch">

            <div id="source_technique" class="padding-5">
              <semantic-form-tree-picker-input  label="Medium" placeholder="Choose the medium" for='source_technique'>
              </semantic-form-tree-picker-input>
            </div>

            <div id="source_dimension" class="padding-5">
              <semantic-form-text-input label="Dimensions" placeholder="H x B" for="source_dimension">
              </semantic-form-text-input>
            </div>

            <div id="source_dimension_unit" class="padding-5">
              <semantic-form-select-input label="Dimension unit" placeholder="select the dimension unit" for="source_dimension_unit">
              </semantic-form-select-input>
            </div>

          </div>

          <hr>

          <!-- Synopsis and Transcription --> 
          <div data-flex-layout="row top-stretch">

             <bs-tabs id="tabs">
              <bs-tab event-key="1" title="Synopsis">
                
                <semantic-form-text-input placeholder="Enter Synopsis ..." multiline="true" rows="5" render-header="false" for='source_synopsis'>
                </semantic-form-text-input> 
              
              </bs-tab>
              <bs-tab event-key="2" title="Transcription">
              
                <semantic-form-text-input placeholder="Enter Transcription ..." multiline="true" rows="5" render-header="false" for='source_transcription'>
                </semantic-form-text-input> 

              </bs-tab>
            </bs-tabs>

          </div>
          
        </div>


      </div>
      <div>
        <h3>Related elements</h3>
      </div>
    </div>

  </div>

</div>

[[> rsp:FormDefaultActions]]
</semantic-form>

<style>
  #form-body{
    margin-top: 50px;
  }

  .margin-top{
    margin-top: 40px;
  }

  .FileManager--header {
    display: none !important;
  }

  .cardinality-support__group-instance, .SemanticTreeInput--inputAndButtons {
    border: none !important;
    padding: 0px !important;
  }

  .cardinality-support__single-instance {
    border: none !important;
  }

  .h-1000{
    min-height: 1000px;
  }

  .padding-5 {
    padding: 0 5px;
  }

  .wrapper {
      display: flex;
      flex-direction: column-reverse;
  }

  .open-archival-unit{
    margin-top: 51px;
    border-radius: 0px;
    padding: 10px;
  }

  #source_location .SemanticTreeInput--browseButton{
    margin-right: 10px;
  }

  #source_location .RemovableBadge {
    background-color: white!important;
  }

  #source_location .RemovableBadge__content, #source_location .RemovableBadge__remove {
    max-width: none!important;
    color: black!important;
  }
</style>